
Status:

This builds, but there are lots of thing left that
need to be "connected up".  See XXX in klm*.c


Random things I noticed:

I think we need NLM sysid values to be unique across all zones.
(So don't make nlm_next_sysid into a per-zone value.)

The os/flock.c code expects sysids to be unique system-wide,
i.e. _not_ just unique per-zone.

I think we also want a separate sysid for every tuple of
client + netaddr, or server + netaddr.

Does the lock manager need to "hold" vnodes active
when there are locks granted to clients?
(I think it does need to, yes.)


I'm not sure which way I like the service stubs done.
Started with nlm_prot_svc.c (generated, and *.sed)
but now I like nlm_prog[234].c better.

Local statmon callbacks:

  NLM_SM_NOTIFY1 = 17, in old LM: PRV_CRASH, lm_crash
	Called when one of our clients reboots.
	Throw away locks held by this client.
	They can come back to reclaim them.
  NLM_SM_NOTIFY2 = 18, in old LM: PRV_RECOVERY, lm_recovery
	Called when one of our servers reboots.
	Do "recovery" (try to reclaim our locks).

